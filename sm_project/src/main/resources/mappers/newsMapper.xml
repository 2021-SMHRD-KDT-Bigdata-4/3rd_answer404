<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="newsMapper">
   
   <!-- 뉴스 작성 -->
   <insert id="insert">
   	   insert into news(news_index,news_title,news_contents,news_categorie,news_url) 
   values (NEWS_INDEX_SEQ.nextval,#{news_title},#{news_contents},#{news_categorie},#{news_url});
   	
   </insert>
	
	<!-- 상세보기 -->
	<select id="detail" parameterType="int" resultType="kr.co.summary.domain.NewsVO">
		select news_index,news_title,news_contents,news_date,news_count,news_categorie
		from news where news_index = #{news_index}
	
	</select>
   
  
   <!-- 페이지네이션 -->
   <select id="listpage" resultType="kr.co.summary.domain.NewsVO" parameterType="kr.co.summary.domain.Criteria">
   
		  select news_index,news_title,news_contents,news_date,news_count,news_categorie,news_image,news_url,news_company
	from( select news_index,news_title,news_contents,news_date,news_count,news_categorie,news_image,news_url,news_company,
	row_number() over(order by news_index desc) as rNum from news 
	where 1=1<include refid="search"></include>
	)ns
	where rNum between #{rowStart} and #{rowEnd} order by news_index desc
   </select>
   
   <!-- 게시물개수 -->
   <select id="listCount" resultType="int">
   select count(news_index) from news where 1=1<include refid="search"></include> and news_index > 0
   
   </select>
   
   <sql id="search">
   		<if test="searchType != null">
   			<if test="searchType == 't'.toString()">and news_title like '%' || #{keyword} || '%'</if>
   			<if test="searchType == 'c'.toString()">and news_contents like '%' || #{keyword} || '%'</if>
   		</if>
   
   </sql>
   
</mapper>